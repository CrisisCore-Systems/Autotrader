# Security & Configuration Architecture - Visual Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         AUTOTRADER SECURITY LAYERS                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            LAYER 1: CI/CD SECURITY                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  Semgrep   â”‚  â”‚   Bandit   â”‚  â”‚   Trivy    â”‚  â”‚  Gitleaks  â”‚       â”‚
â”‚  â”‚  (60+ rules)â”‚  â”‚  (Python)  â”‚  â”‚(Container) â”‚  â”‚ (Secrets)  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚       â”‚               â”‚               â”‚               â”‚                 â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                            â”‚                                             â”‚
â”‚                            â–¼                                             â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚                  â”‚  GitHub Security  â”‚                                   â”‚
â”‚                  â”‚   SARIF Reports   â”‚                                   â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚
â”‚                                                                          â”‚
â”‚  Additional Scanners:                                                   â”‚
â”‚  â€¢ TruffleHog (verified secrets)                                        â”‚
â”‚  â€¢ pip-audit (dependencies)                                             â”‚
â”‚  â€¢ SBOM + Grype (software bill of materials)                            â”‚
â”‚  â€¢ License compliance                                                   â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      LAYER 2: CONFIGURATION GOVERNANCE                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Alert Rules (configs/alert_rules.yaml)                          â”‚   â”‚
â”‚  â”‚  â”œâ”€ JSON Schema validation                                      â”‚   â”‚
â”‚  â”‚  â”œâ”€ Unique ID enforcement                                        â”‚   â”‚
â”‚  â”‚  â”œâ”€ Channel reference validation                                â”‚   â”‚
â”‚  â”‚  â””â”€ Condition logic verification                                â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  Validator: scripts/validate_alert_rules.py âœ…                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Prompt Contracts (schemas/prompt_outputs/*.json)                â”‚   â”‚
â”‚  â”‚  â”œâ”€ Schema version tracking                                     â”‚   â”‚
â”‚  â”‚  â”œâ”€ additionalProperties: false                                 â”‚   â”‚
â”‚  â”‚  â”œâ”€ Golden test fixtures                                        â”‚   â”‚
â”‚  â”‚  â””â”€ Regression testing                                          â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  Validator: scripts/validate_prompt_contracts.py âœ…             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ LLM Configuration (configs/llm_enhanced.yaml)                   â”‚   â”‚
â”‚  â”‚  â”œâ”€ Cost tracking per provider                                  â”‚   â”‚
â”‚  â”‚  â”œâ”€ Fallback chains                                             â”‚   â”‚
â”‚  â”‚  â”œâ”€ Budget caps (daily/per-job)                                 â”‚   â”‚
â”‚  â”‚  â”œâ”€ Rate limiting                                               â”‚   â”‚
â”‚  â”‚  â””â”€ PII redaction                                               â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  Validator: YAML syntax check âœ…                                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       LAYER 3: RUNTIME SECURITY                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚ LLM Request Flow                                      â”‚             â”‚
â”‚  â”‚                                                       â”‚             â”‚
â”‚  â”‚  Request â†’ Rate Limiter â†’ Cost Check â†’ Primary Model â”‚             â”‚
â”‚  â”‚                               â†“ (if fail)            â”‚             â”‚
â”‚  â”‚                           Fallback Chain              â”‚             â”‚
â”‚  â”‚                               â†“                       â”‚             â”‚
â”‚  â”‚                          Cache Check                  â”‚             â”‚
â”‚  â”‚                               â†“                       â”‚             â”‚
â”‚  â”‚                      Audit Log (PII redacted)         â”‚             â”‚
â”‚  â”‚                               â†“                       â”‚             â”‚
â”‚  â”‚                      Schema Validation                â”‚             â”‚
â”‚  â”‚                               â†“                       â”‚             â”‚
â”‚  â”‚                          Response                     â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                          â”‚
â”‚  Monitoring:                                                            â”‚
â”‚  â€¢ llm_cost_usd_total (Prometheus)                                      â”‚
â”‚  â€¢ llm_request_duration_seconds                                         â”‚
â”‚  â€¢ llm_cache_hit_rate                                                   â”‚
â”‚  â€¢ llm_fallback_triggered_total                                         â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      LAYER 4: ARTIFACT GOVERNANCE                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚ Artifact Generation (scripts/generate_artifact.py)    â”‚             â”‚
â”‚  â”‚                                                       â”‚             â”‚
â”‚  â”‚  Input Data                                           â”‚             â”‚
â”‚  â”‚       â†“                                               â”‚             â”‚
â”‚  â”‚  Metadata Generation                                  â”‚             â”‚
â”‚  â”‚   â”œâ”€ Generation ID (UUID v4)                          â”‚             â”‚
â”‚  â”‚   â”œâ”€ Source commit SHA                                â”‚             â”‚
â”‚  â”‚   â”œâ”€ Feature set hash                                 â”‚             â”‚
â”‚  â”‚   â”œâ”€ Model info (if LLM)                              â”‚             â”‚
â”‚  â”‚   â””â”€ Provenance trail                                 â”‚             â”‚
â”‚  â”‚       â†“                                               â”‚             â”‚
â”‚  â”‚  Jinja2 Template Rendering                            â”‚             â”‚
â”‚  â”‚   â”œâ”€ Autoescaping (XSS protection)                    â”‚             â”‚
â”‚  â”‚   â”œâ”€ CSP headers                                      â”‚             â”‚
â”‚  â”‚   â””â”€ Whitelisted variables only                       â”‚             â”‚
â”‚  â”‚       â†“                                               â”‚             â”‚
â”‚  â”‚  Checksum Generation                                  â”‚             â”‚
â”‚  â”‚   â”œâ”€ artifact_sha256                                  â”‚             â”‚
â”‚  â”‚   â””â”€ full_sha256 (with metadata)                      â”‚             â”‚
â”‚  â”‚       â†“                                               â”‚             â”‚
â”‚  â”‚  Artifact Storage                                     â”‚             â”‚
â”‚  â”‚   â”œâ”€ Embedded metadata (HTML/MD/JSON)                 â”‚             â”‚
â”‚  â”‚   â””â”€ Sidecar .meta.json (other formats)              â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                          â”‚
â”‚  Schema: schemas/artifact_metadata.json âœ…                              â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      LAYER 5: NOTEBOOK SAFETY                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚ Notebook Execution Flow (.github/workflows/           â”‚             â”‚
â”‚  â”‚                          notebook-execution.yml)      â”‚             â”‚
â”‚  â”‚                                                       â”‚             â”‚
â”‚  â”‚  Discover Notebooks                                   â”‚             â”‚
â”‚  â”‚       â†“                                               â”‚             â”‚
â”‚  â”‚  Environment Setup                                    â”‚             â”‚
â”‚  â”‚   â”œâ”€ Python 3.11                                      â”‚             â”‚
â”‚  â”‚   â”œâ”€ Dependencies from requirements.txt               â”‚             â”‚
â”‚  â”‚   â””â”€ Papermill + nbconvert                            â”‚             â”‚
â”‚  â”‚       â†“                                               â”‚             â”‚
â”‚  â”‚  Capture Environment Snapshot                         â”‚             â”‚
â”‚  â”‚   â”œâ”€ Python version                                   â”‚             â”‚
â”‚  â”‚   â”œâ”€ Package versions                                 â”‚             â”‚
â”‚  â”‚   â””â”€ Git commit SHA                                   â”‚             â”‚
â”‚  â”‚       â†“                                               â”‚             â”‚
â”‚  â”‚  Execute with Papermill                               â”‚             â”‚
â”‚  â”‚   â”œâ”€ Timeout: 30 minutes                              â”‚             â”‚
â”‚  â”‚   â”œâ”€ PYTHONHASHSEED=42 (reproducible)                 â”‚             â”‚
â”‚  â”‚   â”œâ”€ CI_MODE=true (mock APIs)                         â”‚             â”‚
â”‚  â”‚   â””â”€ Export to build/docs/ (not ../docs)             â”‚             â”‚
â”‚  â”‚       â†“                                               â”‚             â”‚
â”‚  â”‚  Convert to HTML                                      â”‚             â”‚
â”‚  â”‚       â†“                                               â”‚             â”‚
â”‚  â”‚  Extract Metadata                                     â”‚             â”‚
â”‚  â”‚   â”œâ”€ Execution time                                   â”‚             â”‚
â”‚  â”‚   â”œâ”€ Cell count                                       â”‚             â”‚
â”‚  â”‚   â””â”€ Error details (if any)                           â”‚             â”‚
â”‚  â”‚       â†“                                               â”‚             â”‚
â”‚  â”‚  Upload Artifacts (30 day retention)                  â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      LAYER 6: PRE-COMMIT HOOKS                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  Git Commit                                                             â”‚
â”‚       â†“                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚  â”‚ Pre-Commit Checks (automatic)              â”‚                        â”‚
â”‚  â”‚                                            â”‚                        â”‚
â”‚  â”‚  Security:                                 â”‚                        â”‚
â”‚  â”‚   â€¢ detect-private-key                     â”‚                        â”‚
â”‚  â”‚   â€¢ detect-secrets                         â”‚                        â”‚
â”‚  â”‚   â€¢ bandit                                 â”‚                        â”‚
â”‚  â”‚                                            â”‚                        â”‚
â”‚  â”‚  Configuration:                            â”‚                        â”‚
â”‚  â”‚   â€¢ validate-alert-rules âœ¨ NEW           â”‚                        â”‚
â”‚  â”‚   â€¢ validate-prompt-contracts âœ¨ NEW      â”‚                        â”‚
â”‚  â”‚   â€¢ validate-llm-config âœ¨ NEW            â”‚                        â”‚
â”‚  â”‚                                            â”‚                        â”‚
â”‚  â”‚  Quality:                                  â”‚                        â”‚
â”‚  â”‚   â€¢ black (formatting)                     â”‚                        â”‚
â”‚  â”‚   â€¢ ruff (linting)                         â”‚                        â”‚
â”‚  â”‚   â€¢ mypy (type checking)                   â”‚                        â”‚
â”‚  â”‚   â€¢ yamllint                               â”‚                        â”‚
â”‚  â”‚   â€¢ markdownlint                           â”‚                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚       â†“                                                                  â”‚
â”‚  âœ… Pass â†’ Commit                                                       â”‚
â”‚  âŒ Fail â†’ Fix & Retry                                                  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    VALIDATION COMMAND REFERENCE                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ Quick Validation                                     â”‚              â”‚
â”‚  â”‚                                                      â”‚              â”‚
â”‚  â”‚  # All checks                                        â”‚              â”‚
â”‚  â”‚  $ python scripts/validate_all.py                   â”‚              â”‚
â”‚  â”‚                                                      â”‚              â”‚
â”‚  â”‚  # Specific category                                â”‚              â”‚
â”‚  â”‚  $ python scripts/validate_all.py --category config â”‚              â”‚
â”‚  â”‚                                                      â”‚              â”‚
â”‚  â”‚  # Strict mode (fail on warnings)                   â”‚              â”‚
â”‚  â”‚  $ python scripts/validate_all.py --strict          â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ Individual Validators                                â”‚              â”‚
â”‚  â”‚                                                      â”‚              â”‚
â”‚  â”‚  # Alert rules                                       â”‚              â”‚
â”‚  â”‚  $ python scripts/validate_alert_rules.py \         â”‚              â”‚
â”‚  â”‚      --config configs/alert_rules.yaml               â”‚              â”‚
â”‚  â”‚                                                      â”‚              â”‚
â”‚  â”‚  # Prompt contracts                                  â”‚              â”‚
â”‚  â”‚  $ python scripts/validate_prompt_contracts.py      â”‚              â”‚
â”‚  â”‚                                                      â”‚              â”‚
â”‚  â”‚  # Security scan                                     â”‚              â”‚
â”‚  â”‚  $ semgrep --config ci/semgrep.yml src/             â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         MONITORING DASHBOARD                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  Prometheus Metrics (http://localhost:9090)                             â”‚
â”‚                                                                          â”‚
â”‚  Security:                                                              â”‚
â”‚   â€¢ security_scan_findings_total                                        â”‚
â”‚   â€¢ dependency_vulnerabilities_total                                    â”‚
â”‚                                                                          â”‚
â”‚  LLM Operations:                                                        â”‚
â”‚   â€¢ llm_cost_usd_total                                                  â”‚
â”‚   â€¢ llm_request_duration_seconds                                        â”‚
â”‚   â€¢ llm_request_errors_total                                            â”‚
â”‚   â€¢ llm_cache_hit_rate                                                  â”‚
â”‚   â€¢ llm_fallback_triggered_total                                        â”‚
â”‚                                                                          â”‚
â”‚  Artifacts:                                                             â”‚
â”‚   â€¢ artifact_generation_duration_seconds                                â”‚
â”‚   â€¢ artifact_storage_bytes_total                                        â”‚
â”‚                                                                          â”‚
â”‚  Notebooks:                                                             â”‚
â”‚   â€¢ notebook_execution_duration_seconds                                 â”‚
â”‚   â€¢ notebook_execution_errors_total                                     â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          FILE STRUCTURE                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  AutoTrader/Autotrader/                                                 â”‚
â”‚  â”œâ”€â”€ .github/workflows/                                                 â”‚
â”‚  â”‚   â”œâ”€â”€ security-scan.yml          âœ… Comprehensive security           â”‚
â”‚  â”‚   â”œâ”€â”€ notebook-execution.yml     âœ¨ NEW: Papermill CI               â”‚
â”‚  â”‚   â””â”€â”€ tests-and-coverage.yml     âœ… Quality gates                   â”‚
â”‚  â”‚                                                                       â”‚
â”‚  â”œâ”€â”€ configs/                                                           â”‚
â”‚  â”‚   â”œâ”€â”€ alert_rules.yaml           âœ… Validated in CI                 â”‚
â”‚  â”‚   â””â”€â”€ llm_enhanced.yaml          âœ¨ NEW: Cost controls              â”‚
â”‚  â”‚                                                                       â”‚
â”‚  â”œâ”€â”€ schemas/                                                           â”‚
â”‚  â”‚   â”œâ”€â”€ artifact_metadata.json     âœ¨ NEW: Provenance schema          â”‚
â”‚  â”‚   â””â”€â”€ prompt_outputs/            âœ¨ NEW: Prompt schemas             â”‚
â”‚  â”‚       â”œâ”€â”€ narrative_analyzer.json                                   â”‚
â”‚  â”‚       â””â”€â”€ contract_safety.json                                      â”‚
â”‚  â”‚                                                                       â”‚
â”‚  â”œâ”€â”€ scripts/                                                           â”‚
â”‚  â”‚   â”œâ”€â”€ validate_alert_rules.py    âœ… Alert validator                 â”‚
â”‚  â”‚   â”œâ”€â”€ validate_prompt_contracts.py âœ¨ NEW: Prompt validator         â”‚
â”‚  â”‚   â”œâ”€â”€ generate_artifact.py       âœ¨ NEW: Secure generator           â”‚
â”‚  â”‚   â””â”€â”€ validate_all.py            âœ¨ NEW: Comprehensive validator    â”‚
â”‚  â”‚                                                                       â”‚
â”‚  â”œâ”€â”€ tests/fixtures/prompt_outputs/ âœ¨ NEW: Golden tests                â”‚
â”‚  â”‚   â”œâ”€â”€ narrative_analyzer_golden.json                                â”‚
â”‚  â”‚   â””â”€â”€ contract_safety_golden.json                                   â”‚
â”‚  â”‚                                                                       â”‚
â”‚  â”œâ”€â”€ ci/                                                                â”‚
â”‚  â”‚   â””â”€â”€ semgrep.yml                âœ… 60+ custom rules                â”‚
â”‚  â”‚                                                                       â”‚
â”‚  â”œâ”€â”€ .pre-commit-config.yaml        âœ… Enhanced with validators         â”‚
â”‚  â”‚                                                                       â”‚
â”‚  â””â”€â”€ DOCUMENTATION                                                      â”‚
â”‚      â”œâ”€â”€ SECURITY_POSTURE_COMPLETE.md      ğŸ“– Full guide               â”‚
â”‚      â”œâ”€â”€ SECURITY_IMPLEMENTATION_SUMMARY.md ğŸ“Š Executive summary       â”‚
â”‚      â”œâ”€â”€ SECURITY_IMPLEMENTATION_GUIDE.md  ğŸ› ï¸ Implementation guide     â”‚
â”‚      â””â”€â”€ SECURITY_ARCHITECTURE.md          ğŸ“ This file                â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Legend:
  âœ… Already excellent (preserved)
  âœ¨ New implementation
  ğŸ“– Documentation
  ğŸ› ï¸ Tooling
  ğŸ”’ Security
  ğŸ“Š Monitoring

Version: 2.0.0
Date: October 9, 2025
Status: âœ… Production Ready
```
